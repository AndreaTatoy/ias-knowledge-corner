# **Network Traffic Analysis (NTA)**

## **What is Network Traffic Analysis?**

*  **Definition:** The process of capturing, inspecting, and analyzing network data flow.
* **Goal:**
    *  Characterizes the common ports and protocols utilized on the network.
    *  Establishes a **baseline** for normal network behavior.
    *  Monitors and responds to security threats.

### **OSI Model Primer**

 Network traffic analysis relies on understanding the Open Systems Interconnection (OSI) 7-layer reference model for network communications:

| Layer | Name | Function / Examples |
| :---- | :---- | :---- |
| **7** | **Application** |  User interface (e.g., HTTP, FTP). |
| **6** | **Presentation** |  Data formatting (e.g., SSL, TLS). |
| **4** | **Transport** |  Manages end-to-end connections (TCP, UDP). |
| **3** | **Network** |  Handles addressing and routing (IP). |
| **2** | **Data Link** |  Frames data between devices (e.g., Ethernet). |

## **NTA Process and Tools**

### **The Analysis Process**
1.   **Ingest Traffic:** Capture network traffic, using capture filters to reduce initial data volume.
2.   **Reduce Noise by Filtering:** Filter out unnecessary traffic after the initial capture.
3.   **Analyze and Explore:** Carve out data relevant to the security issue.
4.   **Detect and Alert:** Look for errors and leverage tools like Intrusion Detection Systems (IDS) and Intrusion Prevention Systems (IPS).

### **Key Tools**

| Tool | Description |
| :---- | :---- |
| **Wireshark** |  A free and open-source graphical network traffic analyzer capable of deep packet inspection.  It is powerful and versatile. |
| **tcpdump / Tshark** |  Command-line tools for capturing and analyzing network traffic. |

### **Wireshark Filters**

 Wireshark uses two main types of filters for targeted analysis:
*  **Capture Filters:** Used to filter packets **during the capture**.
    *  *Example:* `tcp port 80` (Captures only TCP traffic on port 80).
*  **Display Filters:** Used to filter packets **already captured** and stored in the file.
    *  *Example:* `ip.addr == 192.168.1.1` (Displays traffic to/from that IP).

### **Advanced NTA Feature**

*  **Following TCP Streams:** Wireshark can recreate the entire conversation between two hosts in a readable format.  This allows for the extraction of data (like images or files) from the packet capture.